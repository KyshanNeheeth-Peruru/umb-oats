{% extends 'base.html' %}

{% block title %}Profile{% endblock %}

{% block top_heading %}
    <h1 class="h3 mb-0 text-gray-900">Profile</h1>
{% endblock %}

{% block content %}

<div class="card ml-3">
    <div class="card-body custom-card">

        <div class="row justify-content-center align-items-center py-4">
            <div class="col-md-4 text-center">
                <div class="profile-picture">
                    <img id="image_display" src="{{ request.user.student.profile_picture }}" class="rounded-circle" alt="Profile Picture" width="150" height="150">
                    <label for="id_picture"><i class="fas fa-pencil-alt"></i></label>
                    <input type="file" id="id_picture" name="picture" style="display:none;" onchange="previewFile()">
                </div>
                <h3 class="mt-2">{{ user.username }}</h3>
            </div>
            <div class="col-md-8">
                {% if user.is_authenticated %}
                <article>
                    <form method="post">
                        {% csrf_token %}
                        <div class="col-sm-10 col-md-6">
                            <label for="{{ form.first_name.id_for_label }}" class="form-label-custom"><i class="fas fa-user"></i> First name:</label>
                            {{ form.first_name }}
                        </div>
                        <br>
                        <div class="col-sm-10 col-md-6">
                            <label for="{{ form.last_name.id_for_label }}" class="form-label-custom"><i class="fas fa-user"></i> Last name:</label>
                            {{ form.last_name }}
                        </div>
                        <br>
                        {% if user.student %}
                        <div class="col-sm-10 col-md-6">
                            <label for="{{ form.ums_id.id_for_label }}" class="form-label-custom"><i class="fas fa-id-card"></i> UMB ID:</label>
                            {{ form.ums_id }}
                        </div>
                        <br>
                        <div class="col-sm-10 col-md-6">
                            <label for="{{ form.courses.id_for_label }}" class="form-label-custom"><i class="fas fa-book"></i> Student Courses:</label>
                            {{ form.courses }}
                        </div>

                        {% endif %}
                        <br>

                        <div class="mt-3">
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save changes</button>
                        </div>

                    </form>
                </article>
                {% endif %}
                <div class="h6 text-bg-danger">
                    {% if messages %}
                    {{ messages.last }}
                    {% endif %}
                </div>
            </div>

        </div>
    </div>
</div>

<script>
    function previewFile() {
        const preview = document.getElementById('image_display');
        const file = document.querySelector('input[type=file]').files[0];
        const reader = new FileReader();

        reader.addEventListener("load", function () {
            preview.src = reader.result;
        }, false);

        if (file) {
            reader.readAsDataURL(file);
        }
    }
</script>

<style>
    .form-label-custom {
        color: grey!important;
    }
    .custom-card {
    max-width: 1200px;
    padding: 5px;
    margin-left: 20px;
}

</style>

{% endblock %}
